{"version":3,"file":"js/93.c556ebdb.js","mappings":"wKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,KAAK,CAACF,EAAIK,GAAG,kCAAkCH,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACJ,EAAIK,GAAG,UAAUL,EAAIM,GAAGN,EAAIO,SAAS,iBACzP,EACIC,EAAkB,G,oBCatB,GACAC,KAAA,mBACAC,OACA,OACAH,QAAAI,IAEA,GCrB8P,I,UCO1PC,GAAY,OACd,EACAb,EACAS,GACA,EACA,KACA,WACA,MAIF,EAAeI,EAAiB,O,oBClBhCC,EAAOC,QAAU,i6E","sources":["webpack://snippets-admin/./src/views/permission/index.vue","webpack://snippets-admin/src/views/permission/index.vue","webpack://snippets-admin/./src/views/permission/index.vue?e653","webpack://snippets-admin/./src/views/permission/index.vue?5b79","webpack://snippets-admin/./src/texts/permission.txt"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"page\"},[_c('h4',[_vm._v(\"Permission By Dynamic Routes\")]),_c('div',{staticClass:\"source\"},[_c('pre',{staticClass:\"mb-0\"},[_vm._v(\"// js\\n\"+_vm._s(_vm.content)+\"\\n      \")])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"page\">\r\n    <h4>Permission By Dynamic Routes</h4>\r\n    <div class=\"source\">\r\n      <pre class=\"mb-0\">\r\n// js\r\n{{content}}\r\n      </pre>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport permissionText from '@/texts/permission.txt'\r\n\r\nexport default {\r\n  name: 'permission-index',\r\n  data () {\r\n    return {\r\n      content: permissionText,\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=159839b1&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"159839b1\",\n  null\n  \n)\n\nexport default component.exports","module.exports = \"import NProgress from 'nprogress'\\r\\nimport 'nprogress/nprogress.css'\\r\\nimport router, { getFirstMenuPath } from '@/router'\\r\\nimport store from '@/store'\\r\\nimport { getToken } from '@/utils'\\r\\n\\r\\nconst whiteList = [\\r\\n  /^\\\\/login(?:\\\\/(?=$))?$/i,\\r\\n  /^\\\\/not-found(?:\\\\/(?=$))?$/i,\\r\\n  /^\\\\/redirect\\\\/((?:.*))(?:\\\\/(?=$))?$/i\\r\\n]\\r\\n\\r\\nfunction hasRoute (path) {\\r\\n  const routesConfig = router.getRoutes()\\r\\n  return routesConfig.some(v => v.regex.test(path))\\r\\n}\\r\\n\\r\\nfunction hasPath (routes, path) {\\r\\n  return routes.some((route) => {\\r\\n    if (route.children && route.children.length > 0) {\\r\\n      return hasPath(route.children, path)\\r\\n    }\\r\\n    return route.path === path\\r\\n  })\\r\\n}\\r\\n\\r\\nrouter.beforeEach((to, from, next) => {\\r\\n  const hasToken = !!getToken()\\r\\n  const {\\r\\n    meta,\\r\\n    path,\\r\\n    fullPath\\r\\n  } = to\\r\\n  if (meta && meta.title) {\\r\\n    document.title = meta.title\\r\\n  }\\r\\n  NProgress.start()\\r\\n  if (whiteList.some((v) => v.test(path))) {\\r\\n    next()\\r\\n    NProgress.done()\\r\\n  } else if (!hasToken) {\\r\\n    next({\\r\\n      replace: true,\\r\\n      name: 'Login',\\r\\n      query: {\\r\\n        returnUrl: fullPath\\r\\n      }\\r\\n    })\\r\\n  } else {\\r\\n    if (hasRoute(path)) {\\r\\n      next()\\r\\n    } else {\\r\\n      store.dispatch('user/generateRoutes', path).then((permissionRoutes) => {\\r\\n        if (\\r\\n          permissionRoutes.length === 0 ||\\r\\n          (!hasPath(permissionRoutes, path) && path !== '/')\\r\\n        ) {\\r\\n          // 1、当前路径在菜单中不存在\\r\\n          // 2、当前路径(根路径\\\"/\\\"除外)在菜单中存在，但是没有权限（角色没有勾选该菜单)\\r\\n          next({\\r\\n            name: 'NotFound',\\r\\n            replace: true\\r\\n          })\\r\\n        } else if (path === '/') {\\r\\n          const redirectPath = getFirstMenuPath(permissionRoutes[0])\\r\\n          console.log('redirectPath: ', redirectPath)\\r\\n\\r\\n          next({\\r\\n            path: redirectPath,\\r\\n            replace: true\\r\\n          })\\r\\n        } else {\\r\\n          permissionRoutes.forEach((route) => {\\r\\n            router.addRoute(route)\\r\\n          })\\r\\n          next({\\r\\n            ...to,\\r\\n            replace: true\\r\\n          })\\r\\n        }\\r\\n        NProgress.done()\\r\\n      }).catch(() => {\\r\\n        next({\\r\\n          name: 'NotFound',\\r\\n          replace: true\\r\\n        })\\r\\n      })\\r\\n\\r\\n      NProgress.done()\\r\\n    }\\r\\n  }\\r\\n})\\r\\n\\r\\nrouter.afterEach(() => {\\r\\n  NProgress.done()\\r\\n})\\r\\n\";"],"names":["render","_vm","this","_c","_self","staticClass","_v","_s","content","staticRenderFns","name","data","permissionText","component","module","exports"],"sourceRoot":""}